<!DOCTYPE html>
<html>
<head>
    <title>pick-plaz</title>
    <script src="vue.min.js"></script>
    <script src="pickplaz.js"></script>
    <script src="footprints.js"></script>
    <link rel="stylesheet" href="pickplaz.css">
    <link rel="stylesheet" href="materialicons.css">
    <html lang="en"></html>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="alternate icon" href="/favicon.ico">
</head>
<body onload="start()" class="noselect" style="text-align: center;">
<div id="app" style="width: 100%; max-width: 2600px; margin:0 auto;">

    <div class="menu">
            <a class="logo" href="https://github.com/ftobler/pick-plaz" target="_blank">pick-plaz</a>
            <div class="menu-item" v-bind:class="{active : page == 0}" v-on:click="page = 0">Parts</div>
            <div class="menu-item" v-bind:class="{active : page == 1}" v-on:click="page = 1">Feeder</div>
            <div class="menu-item" v-bind:class="{active : page == 2}" v-on:click="page = 2">Navigate</div>       

        <div style="float: right;">
            <div class="menu-pane">
                <div class="menu-label">PNP</div>
                <input class="menu-content" type="file" id="myFile" name="filename">
                <div class="menu-upload">north</div>
            </div>
            <div class="menu-pane">
                <div class="menu-label">BOM</div>
                <input class="menu-content" type="file" id="myFile" name="filename">
                <div class="menu-upload">north</div>
            </div>
            <div class="menu-material-pane">
                <div class="menu-material">play_arrow</div>
                <div class="menu-material">pause</div>
                <div class="menu-material stop">stop</div>
            </div>
        </div>

    </div>

    <div class="content">

        <div v-if="page == 0">

            <table>
                <tr>
                    <th width="20px">#</th>
                    <th class="small" width="20px">Place</th>
                    <th class="small" width="20px">Fiducal</th>
                    <th width="200px">Value</th>
                    <th width="200px">Footprint</th>
                    <th width="150px"></th>
                    <th width="200px">Part Nr</th>
                    <th width="200px">Designator</th>
                    <th width="200px">X</th>
                    <th width="200px">Y</th>
                    <th width="200px">Rotation</th>
                    <th width="200px">Status</th>
                    <th width="200px">Feeder</th>
                    <th width="400px">Action</th>
                </tr>
                <tr v-for="(entry, i) in db.bom">
                    <td :rowspan="entry.parts.length">{{i}}</td>
                    <td><input type="checkbox" v-model="entry.place"  v-if="!entry.fiducal"></td>
                    <td><input type="checkbox" v-model="entry.fiducal"></td>
                    <td>{{entry.value}}</td>
                    <td>{{entry.footprint}}</td>
                    <td><img v-bind:src="entry.footprint | footprint_img_path"/> &nbsp;&nbsp;<img v-bind:src="entry.footprint | footprint_sym_path"/></td>
                    <td><a v-bind:href="'https://lcsc.com/search?q=' + entry.partnr" target="_blank">{{entry.partnr}}</a></td>
                    <td class="cell-inline-table" colspan=5>
                        <table class="cell-inline-table">
                            <tr v-for="(part, id) in entry.parts">
                                <td width="200px">{{id}}</td>
                                <td width="200px">{{part.x}}</td>
                                <td width="200px">{{part.y}}</td>
                                <td width="200px"><div class="table-button material">refresh</div> {{part.rot}}</td>
                                <td width="200px"><div class="table-button material">swap_horiz</div> {{part.state}}</td>
                            </tr>
                        </table>
                    </td>
                    <td contenteditable>{{entry.feeder}}</td> <!-- https://codepen.io/supraniti/pen/Lypobx -->
                    <td><button>view place</button> <button>view pick</button> <button>do place</button></td>
                </tr>
            
            </table>
        </div>

        <div v-if="page == 1">
            <table>
                <tr>
                    <th width="300px">Name</th>
                    <th width="300px">Type</th>
                    <th width="300px">X</th>
                    <th width="300px">Y</th>
                    <th width="300px">width</th>
                    <th width="300px">height</th>
                    <th width="300px">Pitch</th>
                    <th width="300px">Orientation</th>
                    <th width="300px">Action</th>
                </tr>
                <tr v-for="(entry, name) in db.feeder">
                    <td>{{name}}</td>
                    <td>{{entry.type}}</td>
                    <td>{{entry.x}}</td>
                    <td>{{entry.y}}</td>
                    <td>{{entry.width}}</td>
                    <td>{{entry.height}}</td>
                    <td>{{entry.pitch}}</td>
                    <td>{{entry.Orientation}}</td>
                    <td><button>pick</button></td>
                </tr>
            </table>
        </div>

        <div v-if="page == 2" @mousemove="mousemove">
            <div style="margin-bottom: 20px">
                <label class="switch"><input type="checkbox" checked v-model="elements.show_camera"><span class="slider round"></span></label>
                <label class="switcher-label">show camera</label>
                <label class="switch"><input type="checkbox" checked v-model="elements.center_camera"><span class="slider round"></span></label>
                <label class="switcher-label">center camera</label>
                <label class="switch"><input type="checkbox" checked v-model="elements.show_components"><span class="slider round"></span></label>
                <label class="switcher-label">show component graphics</label>
                <label class="switch"><input type="checkbox" checked v-model="elements.show_symbol"><span class="slider round"></span></label>
                <label class="switcher-label">show symbols</label>
                <span style="width: 330px; display: inline-block"><label v-if="nav_init">mouse: ({{canvas.cursor_mm.x}}/{{canvas.cursor_mm.y}})mm; robot ({{nav.camera.x}}/{{nav.camera.y}})mm</label></span>
            </div >
            <canvas id="canvas-view" width="1850" height="800" @mousemove="show_coordinates" v-on:click="draw_stuff()" @mousewheel="mousewheel" @mousedown="mousedown" @mouseup="mouseup"></canvas>

            
        </div>
    </div>

</div>
</body>
</html>